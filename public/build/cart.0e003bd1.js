(window.webpackJsonp=window.webpackJsonp||[]).push([["cart"],{F8JR:function(e,t,r){"use strict";var n=r("tycR").forEach,o=r("pkCn"),a=r("rkAj"),i=o("forEach"),c=a("forEach");e.exports=i&&c?[].forEach:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}},FZtP:function(e,t,r){var n=r("2oRo"),o=r("/byt"),a=r("F8JR"),i=r("kRJp");for(var c in o){var l=n[c],u=l&&l.prototype;if(u&&u.forEach!==a)try{i(u,"forEach",a)}catch(e){u.forEach=a}}},QWBl:function(e,t,r){"use strict";var n=r("I+eb"),o=r("F8JR");n({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},xZLW:function(e,t,r){"use strict";r.r(t);r("wLYn"),r("eoL8"),r("XENs"),r("SYky");var n=r("q1tI"),o=r.n(n),a=r("lya3"),i=(r("pNMO"),r("4Brf"),r("0oug"),r("yyme"),r("QWBl"),r("pjDv"),r("J30X"),r("4mDm"),r("2B1R"),r("E9XD"),r("+2oP"),r("DQNa"),r("sMBO"),r("uL8W"),r("NBAS"),r("ExoC"),r("07d7"),r("SuFq"),r("JfAA"),r("PKPk"),r("FZtP"),r("3bBZ"),r("vDqi")),c=r.n(i),l=r("IP2g"),u=r("wHSu"),s=r("2oG/");function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b(e);if(t){var o=b(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function p(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?y(e):t}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(i,e);var t,r,n,a=h(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this,e)).state={itemCount:e.itemCount},t.handleClickAddToCart=t.handleClickAddToCart.bind(y(t)),t.handleClickRemoveFromCart=t.handleClickRemoveFromCart.bind(y(t)),t}return t=i,(r=[{key:"handleClickAddToCart",value:function(e){this.setState((function(e){return{itemCount:e.itemCount+1}}),(function(){this.props.onCountChanged(this.props.item.id,this.state.itemCount)}))}},{key:"handleClickRemoveFromCart",value:function(e){this.setState((function(e){return{itemCount:e.itemCount>0?e.itemCount-1:0}}),(function(){this.props.onCountChanged(this.props.item.id,this.state.itemCount)}))}},{key:"render",value:function(){return 0===this.state.itemCount?"":o.a.createElement("div",{className:"row m-3"},o.a.createElement("div",{className:"col-2"},o.a.createElement("img",{src:"https://img.pizza/100/100?"+this.props.item.id.toString(),alt:"...",className:"img-thumbnail"})),o.a.createElement("div",{className:"col-3"},o.a.createElement("p",null,o.a.createElement("b",null,this.props.item.title)),o.a.createElement("p",null,o.a.createElement("small",{className:"text-secondary"},this.props.item.description))),o.a.createElement("div",{className:"col-3"},o.a.createElement("p",null,s.a.currencyStringRule(this.props.item.price*this.state.itemCount,this.props.currencyCode))),o.a.createElement("div",{className:"col-4 text-right"},1===this.state.itemCount?o.a.createElement("button",{className:"btn btn-success btn-add-to-cart",id:"add-to-cart-"+this.props.item.id.toString(),onClick:this.handleClickRemoveFromCart},o.a.createElement(l.a,{icon:u.b})):o.a.createElement("button",{className:"btn btn-success btn-remove-from-cart",id:"remove-from-cart-"+this.props.item.id.toString(),onClick:this.handleClickRemoveFromCart},o.a.createElement(l.a,{icon:u.a})),o.a.createElement("span",{className:"ml-3 mr-3"},"x",this.state.itemCount),o.a.createElement("button",{className:"btn btn-success btn-add-to-cart",id:"add-to-cart-"+this.props.item.id.toString(),onClick:this.handleClickAddToCart},"+",s.a.currencyStringRule(this.props.item.price,this.props.currencyCode))))}}])&&m(t.prototype,r),n&&m(t,n),i}(n.Component);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e){return function(e){if(Array.isArray(e))return E(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return E(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=N(e);if(t){var o=N(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return k(this,r)}}function k(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?P(e):t}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(l,e);var t,r,n,i=O(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=i.call(this,e)).state={cartStorage:new a.a},t.handleOrderSubmit=t.handleOrderSubmit.bind(P(t)),t}return t=l,(r=[{key:"componentDidMount",value:function(){this.validateForm()}},{key:"handleOrderSubmit",value:function(){var e=this;c()({method:"post",url:"/api/order",data:{items:g(this.props.cart.entries()),contacts:{username:document.getElementById("username").value,address:document.getElementById("userAddress").value,phone:document.getElementById("contactPhone").value},usdRate:1.15,totalPrice:this.props.totalPrice,idempotencyKey:this.state.cartStorage.getIdempotencyKey()}}).then((function(t){412!=t.status&&(200==t.status?(e.state.cartStorage.reset(),e.state.cartStorage.updateIdempotencyKey(),e.props.onDone()):e.props.onError())})).catch((function(){e.props.onError()}))}},{key:"validateForm",value:function(){0===[document.getElementById("username"),document.getElementById("userAddress"),document.getElementById("contactPhone")].reduce((function(e,t){var r,n;return""===t.value?((n=t.classList).add.apply(n,["border","border-danger"]),1):((r=t.classList).remove.apply(r,["border","border-danger"]),0)}),0)?document.getElementById("btnSubmitOrder").classList.remove("disabled"):document.getElementById("btnSubmitOrder").classList.add("disabled")}},{key:"render",value:function(){return o.a.createElement("div",{className:"mt-5"},o.a.createElement("h4",null,"Please fill in the form below to make an order:"),o.a.createElement("form",null,o.a.createElement("div",{className:"form-group row"},o.a.createElement("label",{htmlFor:"username",className:"col-sm-2 col-form-label"},"Name"),o.a.createElement("div",{className:"col-sm-4"},o.a.createElement("input",{type:"text",className:"form-control",id:"username",onChange:this.validateForm}))),o.a.createElement("div",{className:"form-group row"},o.a.createElement("label",{htmlFor:"userAddress",className:"col-sm-2 col-form-label"},"Address"),o.a.createElement("div",{className:"col-sm-4"},o.a.createElement("input",{type:"text",className:"form-control",id:"userAddress",onChange:this.validateForm}))),o.a.createElement("div",{className:"form-group row"},o.a.createElement("label",{htmlFor:"contactPhone",className:"col-sm-2 col-form-label"},"Phone"),o.a.createElement("div",{className:"col-sm-4"},o.a.createElement("input",{type:"tel",className:"form-control",id:"contactPhone",onChange:this.validateForm}))),o.a.createElement("button",{type:"button",id:"btnSubmitOrder",className:"btn btn-primary",onClick:this.handleOrderSubmit},"Submit order")))}}])&&S(t.prototype,r),n&&S(t,n),l}(n.Component),j=function(e){var t=e.handleClose,r=e.show,n=e.config,a=r?"modal display-block":"modal display-none";return o.a.createElement("div",{className:a},o.a.createElement("section",{className:"modal-main"},o.a.createElement("h4",null,n.title),o.a.createElement("p",null,n.text),o.a.createElement("button",{type:"button",className:"btn btn-primary float-right",onClick:t},"Close")))};function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=D(e);if(t){var o=D(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return B(this,r)}}function B(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?M(e):t}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(i,e);var t,r,n,a=T(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=a.call(this,e)).state={items:[],loading:!0,cartEmpty:!1,orderSubmitted:!1,deliveryPrice:0,currencyCode:e.currencyCode,modal:{title:"",text:""},showModal:!1,modalCallback:t.hideModal},t.itemRefs=[],t.loadItems=t.loadItems.bind(M(t)),t.handleCountChanged=t.handleCountChanged.bind(M(t)),t.getTotalPrice=t.getTotalPrice.bind(M(t)),t.hideModal=t.hideModal.bind(M(t)),t.handleOrderSubmitted=t.handleOrderSubmitted.bind(M(t)),t.handleOrderFailed=t.handleOrderFailed.bind(M(t)),t.setCurrencyCode=t.setCurrencyCode.bind(M(t)),t}return t=i,(r=[{key:"componentDidMount",value:function(){this.loadItems()}},{key:"loadItems",value:function(){var e=this;c()({method:"post",url:"/api/cart",data:{items:A(this.props.cart).map((function(e){return e[0]}))}}).then((function(t){var r=t.data;console.log("Loaded",r),e.itemRefs=Array(r.items.length).fill(null).map((function(){return o.a.createRef()}));var n=A(e.props.cart).reduce((function(e,t){return e+t[1]}),0);e.setState({items:r.items,loading:!1,cartEmpty:0===n,deliveryPrice:r.deliveryPrice})}))}},{key:"setCurrencyCode",value:function(e){console.log(s.a),this.setState({currencyCode:e})}},{key:"handleOrderSubmitted",value:function(){this.setState({orderSubmitted:!0,modal:{title:"Error occurred",text:"Order submit failed, please try one more time"},showModal:!0,modalCallback:function(){window.location="/"}})}},{key:"handleOrderFailed",value:function(){this.setState({modal:{title:"Error occurred",text:"Order submit failed, please try one more time"},showModal:!0,modalCallback:this.hideModal})}},{key:"hideModal",value:function(){this.setState({modal:{title:"",text:""},showModal:!1})}},{key:"handleCountChanged",value:function(e,t){this.props.onItemCountChanged(e,t);var r=A(this.props.cart).reduce((function(e,t){return e+t[1]}),0);this.setState({cartEmpty:0===r})}},{key:"getTotalPrice",value:function(){var e=this;return A(this.props.cart).reduce((function(t,r){return t+e.getItemPrice(r[0])*r[1]}),0)+this.state.deliveryPrice}},{key:"getItemPrice",value:function(e){var t=0;return this.state.items.forEach((function(r){r.id===e&&(t=r.price)})),t}},{key:"render",value:function(){var e=this;return this.state.orderSubmitted?o.a.createElement("div",null,o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"card-body"},"Thank you for your order! We will deliver it within an hour."))):this.state.cartEmpty?o.a.createElement("div",null,o.a.createElement("div",{className:"card"},o.a.createElement("div",{className:"card-body"},"Your cart is empty."))):o.a.createElement("div",null,o.a.createElement(j,{show:this.state.showModal,handleClose:this.state.modalCallback,config:this.state.modal}),this.state.loading?o.a.createElement("div",{className:"spinner-border",role:"status"},o.a.createElement("span",{className:"sr-only"},"Loading...")):this.state.items.map((function(t,r){var n;return o.a.createElement(v,{item:t,itemCount:null!==(n=e.props.cart.get(t.id))&&void 0!==n?n:0,onCountChanged:e.handleCountChanged,currencyCode:e.state.currencyCode,ref:e.itemRefs[r],key:r})}),this),o.a.createElement("div",{className:"mt-3"},"+",s.a.currencyStringRule(this.state.deliveryPrice,this.state.currencyCode)," for delvery"),o.a.createElement("div",{className:"mt-3"},"Total price: ",s.a.currencyStringRule(this.getTotalPrice(),this.state.currencyCode)),this.state.cartEmpty?"":o.a.createElement(R,{onDone:this.handleOrderSubmitted,onError:this.handleOrderFailed,cart:this.props.cart,totalPrice:this.getTotalPrice()}))}}])&&F(t.prototype,r),n&&F(t,n),i}(n.Component),J=r("i8i4"),W=r.n(J),Z=r("VO4U");function K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var q=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cartStorage=new a.a,this.currencyCode=this.cartStorage.getCurrency(),this.cartStorage.load(),this.init=this.init.bind(this),this.handleItemCountChanged=this.handleItemCountChanged.bind(this),this.handleCurrencyChange=this.handleCurrencyChange.bind(this)}var t,r,n;return t=e,(r=[{key:"init",value:function(e,t){this.cartStorage.exists()||(window.location="/"),this.CartElement=o.a.createElement(L,{cart:this.cartStorage.cart,onItemCountChanged:this.handleItemCountChanged,currencyCode:this.currencyCode}),this.CurrnecyElement=o.a.createElement(Z.a,{value:this.currencyCode,onChange:this.handleCurrencyChange}),W.a.render(this.CurrnecyElement,document.getElementById(t)),this.cartObject=W.a.render(this.CartElement,document.getElementById(e))}},{key:"handleCurrencyChange",value:function(e){this.cartStorage.setCurrency(e),this.currencyCode=e,this.cartObject.setCurrencyCode(e)}},{key:"handleItemCountChanged",value:function(e,t){this.cartStorage.cart.set(e,t>0?t:0),this.cartStorage.save()}}])&&K(t.prototype,r),n&&K(t,n),e}());document.addEventListener("DOMContentLoaded",(function(){q.init("cart","currency-container")}));t.default=q}},[["xZLW","runtime",0,1]]]);